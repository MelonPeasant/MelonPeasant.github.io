(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{467:function(a,t,o){"use strict";o.r(t);var s=o(2),r=Object(s.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h2",{attrs:{id:"说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#说明"}},[a._v("#")]),a._v(" 说明")]),a._v(" "),t("p",[a._v("mmcblk0p2：Bootargs分区，存放启动参数负责引导到哪个分区启动"),t("br"),a._v("\nmmcblk0p7：BusyBox分区，负责自动刷机到mmcblk0p9"),t("br"),a._v("\nmmcblk0p8：Backup分区，存放需要刷机的数据"),t("br"),a._v("\nmmcblk0p9：Rootfs分区，日常使用的系统存放分区")]),a._v(" "),t("h2",{attrs:{id:"bootargs分区"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#bootargs分区"}},[a._v("#")]),a._v(" Bootargs分区")]),a._v(" "),t("p",[a._v("启动busyboxs时，Bootargs分区")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("baudrate=115200\nethaddr=00:01:02:03:04:05\nipaddr=192.168.1.10\nnetmask=255.255.255.0\ngatewayip=192.168.1.1\nserverip=192.168.1.1\nbootcmd=mmc read 0 0x1FFFFC0 0x7000 0xA000;bootm 0x1FFFFC0\nbootargs_512M=mem=512M mmz=ddr,0,0,48M vmalloc=500M\nbootargs_1G=mem=1G mmz=ddr,0,0,48M vmalloc=500M\nbootargs_2G=mem=2G mmz=ddr,0,0,48M vmalloc=500M\nbootargs_768M=mem=768M mmz=ddr,0,0,48M vmalloc=500M\nbootargs_1536M=mem=1536M mmz=ddr,0,0,48M vmalloc=500M\nbootargs_3840M=mem=3840M mmz=ddr,0,0,48M vmalloc=500M\nbootargs=console=ttyAMA0,115200 root=/dev/mmcblk0p7 rootfstype=ext4 rootwait blkdevparts=mmcblk0:1M(boot),1M(bootargs),4M(baseparam),4M(pqparam),4M(logo),20M(kernel),64M(busybox),512M(backup),-(rootfs)\nbootdelay=0\nstdin=serial\nstdout=serial\nstderr=serial\n")])])]),t("p",[a._v("启动rootfs时，Bootargs分区")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("baudrate=115200\nethaddr=00:01:02:03:04:05\nipaddr=192.168.1.10\nnetmask=255.255.255.0\ngatewayip=192.168.1.1\nserverip=192.168.1.1\nbootcmd=mmc read 0 0x1FFFFC0 0x7000 0xA000;bootm 0x1FFFFC0\nbootargs_512M=mem=512M mmz=ddr,0,0,48M vmalloc=500M\nbootargs_1G=mem=1G mmz=ddr,0,0,48M vmalloc=500M\nbootargs_2G=mem=2G mmz=ddr,0,0,48M vmalloc=500M\nbootargs_768M=mem=768M mmz=ddr,0,0,48M vmalloc=500M\nbootargs_1536M=mem=1536M mmz=ddr,0,0,48M vmalloc=500M\nbootargs_3840M=mem=3840M mmz=ddr,0,0,48M vmalloc=500M\nbootargs=console=ttyAMA0,115200 root=/dev/mmcblk0p9 rootfstype=ext4 rootwait blkdevparts=mmcblk0:1M(boot),1M(bootargs),4M(baseparam),4M(pqparam),4M(logo),20M(kernel),64M(busybox),512M(backup),-(rootfs)\nbootdelay=0\nstdin=serial\nstdout=serial\nstderr=serial\n")])])]),t("p",[a._v("制作文件")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("mkbootargs -s 64 -r bootargs_input.txt -o bootargs.bin\n")])])]),t("h2",{attrs:{id:"busybox分区"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#busybox分区"}},[a._v("#")]),a._v(" Busybox分区")]),a._v(" "),t("p",[t("code",[a._v("/etc/init.d/rcS")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('echo -e "Welcome to Ubuntu"\n/bin/mount -a\necho -e "Remounting the root filesystem"\nmount  -o  remount,rw  /\nmkdir -p /dev/pts\nmount -t devpts devpts /dev/pts\necho /sbin/mdev > /proc/sys/kernel/hotplug\nmdev -s\nudhcpc\n\nmkdir -p /backup\nmount /dev/mmcblk0p8 /backup\ngunzip -c /backup/rootfs.ext4.gz | dd of=/dev/mmcblk0p9 bs=1024\ndd if=/backup/bootargs-9.bin of=/dev/mmcblk0p2 bs=1024 count=1024\numount /backup\nreboot\n')])])]),t("h2",{attrs:{id:"backup分区"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#backup分区"}},[a._v("#")]),a._v(" Backup分区")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("bootargs-7.bin\nbootargs-9.bin\nrootfs.ext4.gz\n")])])]),t("h2",{attrs:{id:"rootfs分区"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rootfs分区"}},[a._v("#")]),a._v(" Rootfs分区")]),a._v(" "),t("p",[t("code",[a._v("/usr/bin/recover.sh")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("#!/bin/bash\n\nmkdir -p /backup\nmount /dev/mmcblk0p8 /backup\ndd if=/backup/bootargs-7.bin of=/dev/mmcblk0p2 bs=1024 count=1024\numount /backup\nreboot\n")])])]),t("p",[a._v("赋予执行权限")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("chmod +x /usr/bin/recover.sh\n")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);