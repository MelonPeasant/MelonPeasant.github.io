(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{463:function(a,t,e){"use strict";e.r(t);var s=e(2),r=Object(s.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"_1、realm"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、realm"}},[a._v("#")]),a._v(" 1、REALM")]),a._v(" "),t("h3",{attrs:{id:"_1-1、访问github-release页面-下载最新版程序包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1、访问github-release页面-下载最新版程序包"}},[a._v("#")]),a._v(" 1.1、访问Github Release页面, 下载最新版程序包")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("mkdir -p /etc/realm && cd /etc/realm  \n")])])]),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("wget https://github.com/zhboner/realm/releases/download/v2.6.2/realm-x86_64-unknown-linux-gnu.tar.gz\n")])])]),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("tar -zxvf realm-x86_64-unknown-linux-gnu.tar.gz\n")])])]),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("chmod +x realm  \n")])])]),t("h3",{attrs:{id:"_1-2、编辑配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2、编辑配置文件"}},[a._v("#")]),a._v(" 1.2、编辑配置文件")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("vim ./config.json\n")])])]),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('{\n  "log": {\n  \t"level": "warn"\n  },\n  "dns": {\n    "mode": "ipv4_and_ipv6",\n    "protocol": "tcp_and_udp",\n    "min_ttl": 0,\n    "max_ttl": 60,\n    "cache_size": 5\n  },\n  "network": {\n    "use_udp": true,\n    "zero_copy": true,\n    "fast_open": true,\n    "tcp_timeout": 300,\n    "udp_timeout": 30,\n    "send_proxy": false,\n    "send_proxy_version": 2,\n    "accept_proxy": false,\n    "accept_proxy_timeout": 5\n  },\n    "endpoints": [\n   {\n\t"listen": "0.0.0.0:12345",\n\t"remote": "1.1.1.1:12345"\n   }\n    ]\n}\n')])])]),t("p",[a._v("测试运行")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("./realm -c config.json\n")])])]),t("h3",{attrs:{id:"_1-3、设置开机启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-3、设置开机启动"}},[a._v("#")]),a._v(" 1.3、设置开机启动")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("vim /etc/systemd/system/realm.service\n")])])]),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("[Unit]\nDescription=realm\nAfter=network-online.target\nWants=network-online.target systemd-networkd-wait-online.service\n \n[Service]\nType=simple\nUser=root\nRestart=on-failure\nRestartSec=5s\nDynamicUser=true\nWorkingDirectory=/etc/realm\nExecStart=/etc/realm/realm -c /etc/realm/config.json\n \n[Install]\nWantedBy=multi-user.target\n")])])]),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("systemctl enable realm\n")])])]),t("h1",{attrs:{id:"_2、redir"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2、redir"}},[a._v("#")]),a._v(" 2、REDIR")]),a._v(" "),t("h3",{attrs:{id:"_2-1、安装redir"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1、安装redir"}},[a._v("#")]),a._v(" 2.1、安装Redir")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("apt install redir -y\n")])])]),t("h3",{attrs:{id:"_2-2、端口转发"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2、端口转发"}},[a._v("#")]),a._v(" 2.2、端口转发")]),a._v(" "),t("p",[a._v("将本地11510端口转到192.168.180.10的443端口")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("redir :11510 192.168.180.10:443\n")])])]),t("h1",{attrs:{id:"_3、iptables"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3、iptables"}},[a._v("#")]),a._v(" 3、IPTABLES")]),a._v(" "),t("h3",{attrs:{id:"_3-0、安装iptables"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-0、安装iptables"}},[a._v("#")]),a._v(" 3.0、安装iptables")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("apt install iptables -y\n")])])]),t("h3",{attrs:{id:"_3-1、打开包转发功能"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1、打开包转发功能"}},[a._v("#")]),a._v(" 3.1、打开包转发功能：")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('echo "1" > /proc/sys/net/ipv4/ip_forward\n')])])]),t("h3",{attrs:{id:"_3-2、修改-etc-sysctl-conf文件-让包转发功能在系统启动时自动生效"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2、修改-etc-sysctl-conf文件-让包转发功能在系统启动时自动生效"}},[a._v("#")]),a._v(" 3.2、修改/etc/sysctl.conf文件，让包转发功能在系统启动时自动生效：")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("vim /etc/sysctl.conf\n")])])]),t("p",[a._v("在文件结尾加入如下内容：")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("net.ipv4.ip_forward = 1\n")])])]),t("h3",{attrs:{id:"_3-3、打开iptables的nat功能"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3、打开iptables的nat功能"}},[a._v("#")]),a._v(" 3.3、打开iptables的NAT功能")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\n")])])]),t("p",[a._v("说明：上面的语句中eth0是连接外网或者连接Internet的网卡：")]),a._v(" "),t("h3",{attrs:{id:"_3-4、保存iptables的规则"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-4、保存iptables的规则"}},[a._v("#")]),a._v(" 3.4、保存iptables的规则")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("service iptables save\n")])])]),t("p",[a._v("不执行的话也可以生效，重启后失效")]),a._v(" "),t("h3",{attrs:{id:"_3-5、将本地的端口转发到本机端口"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-5、将本地的端口转发到本机端口"}},[a._v("#")]),a._v(" 3.5、将本地的端口转发到本机端口")]),a._v(" "),t("p",[a._v("将本机的7777端口转发到本机6666端口")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("iptables -t nat -A PREROUTING -p tcp --dport 7777 -j REDIRECT --to-port 6666\n")])])]),t("h3",{attrs:{id:"_3-6、将本机的端口转发到其他机器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-6、将本机的端口转发到其他机器"}},[a._v("#")]),a._v(" 3.6、将本机的端口转发到其他机器")]),a._v(" "),t("p",[a._v("将本机的8080端口转发到的192.168.1.1的80端口")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("iptables -t nat -A PREROUTING -p tcp --dport 8080 -j DNAT --to-destination 192.168.1.1:80\n")])])]),t("h3",{attrs:{id:"_3-7、查看当前iptables的配置情况"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-7、查看当前iptables的配置情况"}},[a._v("#")]),a._v(" 3.7、查看当前iptables的配置情况")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("iptables -t nat -nL --line\n")])])]),t("h3",{attrs:{id:"_3-8、一键配置端口转发"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-8、一键配置端口转发"}},[a._v("#")]),a._v(" 3.8、一键配置端口转发")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("bash <(curl -fsSL https://raw.githubusercontent.com/arloor/iptablesUtils/master/natcfg.sh)\n")])])]),t("h1",{attrs:{id:"_4、nftables"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4、nftables"}},[a._v("#")]),a._v(" 4、NFTABLES")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("nft add table ip nat\nnft add chain nat PREROUTING { type nat hook prerouting priority \\ -100 \\; }\nnft add chain nat POSTROUTING { type nat hook postrouting priority \\ -100 \\; }\n      \nnft add rule ip nat PREROUTING tcp dport 11510 counter dnat to 4.4.4.4:443\nnft add rule ip nat PREROUTING udp dport 11510 counter dnat to 4.4.4.4:443\n\nnft add rule ip nat POSTROUTING ip daddr $remote_ip tcp dport $remote_port counter snat to $local_ip\nnft add rule ip nat POSTROUTING ip daddr $remote_ip udp dport $remote_port counter snat to $local_ip\n\n\n\nnft list ruleset\n")])])]),t("p",[a._v("TO DO LIST……")])])}),[],!1,null,null,null);t.default=r.exports}}]);